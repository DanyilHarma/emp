# Проект: Учи.ру (B2C, EdTech) — https://uchi.ru/

## Описание проекта (что это такое?)

**Учи.ру** — крупнейшая российская образовательная онлайн-платформа для школьников, родителей и учителей. Платформа предлагает интерактивные курсы, домашние задания, олимпиады и аналитику успеваемости, формируя персонализированную траекторию обучения для каждого ученика.

Система адаптирует задания под уровень школьника, помогает педагогам автоматизировать работу, а родителям — отслеживать прогресс. Платформа активно используется как в школах, так и в домашнем обучении.

На техническом уровне платформа реализована как полноценное SPA-приложение на React + Next.js, с использованием CSS Modules и styled-components одновременно — гибкий подход позволяет переключаться между декларативной стилизацией и scoped-модулями. Стек ориентирован на высокую отзывчивость, с проработанным кешированием, аналитикой и fallback-механиками. Авторизация построена на JWT и обрабатывается через кастомный `service worker`, обеспечивая обновление токенов на лету и синхронизацию авторизации между вкладками.

---

## Кто и как им пользуется

-   **Ученики**: решают задания, проходят курсы, участвуют в олимпиадах.
-   **Учителя**: создают и назначают задания, следят за результатами, получают аналитику.
-   **Родители**: видят прогресс ребёнка, управляют подписками.
-   **Администраторы**: модерируют контент, контролируют техническое состояние системы.

Роли чётко разграничены. Интерфейсы адаптированы под каждую аудиторию, включая состояния "неавторизованного" гостя — отслеживаются через уникальные `GuestUUID` и `GuestID`, выдаваемые при первом входе.

---

## Что мне сразу бросилось в глаза

Каждый функциональный блок реализован как отдельный микрофронт. Видна чёткая модульность: курсы, олимпиада, кабинет ученика, магазин, уведомления и пр.

В интерфейсе — крупные элементы, фокус на понятности, анимации, реактивность. Используется прогрессивная подгрузка контента, chunk'и, CDN.

Платформа ощущается зрелой: есть fallback-механизмы, адаптивный UI, A/B-тестирование, аналитика в реальном времени. Авторизация реализована устойчиво — JWT проксируется через сервис-воркер и периодически обновляется через endpoint `/auth/jwt-refresh`, с учётом срока действия токена.

Также ощущается продуманность в вопросах отказоустойчивости: `cache-control`, `etag`, `HSTS`, сжатие через `gzip`, строгие политики безопасности (`strict-origin-when-cross-origin`, `private, no-cache, must-revalidate`).

---

## Структура продукта по блокам

-   Интерактивные курсы
-   Олимпиады и проверочные работы
-   Домашние задания
-   Личные кабинеты (ученик, родитель, учитель)
-   Магазин курсов и подписок
-   Система достижений и наград
-   Статистика и метрики
-   Уведомления и напоминания
-   Панель администрирования и модерации

Каждый блок физически отделён — как на уровне роутов, так и chunk'ов. Присутствуют отдельные endpoints авторизации, а также кастомные метрики и события (`tracker`, `collect`, `dyn-goal-config`), распределённые между фронтендом и поддоменом `evt.uchi.ru`.

---

## Примерный стек

-   **Frontend**: React + TypeScript (возможно, частично MobX), CSS Modules + styled-components
-   **State**: локально Redux, но глобально — ощущается архитектура с MobX store
-   **Backend**: Ruby on Rails + Node.js, API в формате REST + SSE
-   **Сборка**: Webpack с код-сплиттингом, чанками
-   **Realtime**: используется SSE (Server-Sent Events) для обратной связи
-   **CDN и кеширование**: активная отдача через CDN, кеш по `ETag` и `Cache-Control`
-   **Логирование**: собственный клиентский логгер + Sentry
-   **Трекинг**: Яндекс.Метрика, Google Analytics (GA4), AppMetrica, Mail.ru Top JS, web-vitals

Также задействованы:

-   **Google Tag Manager** для управления трекерами
-   **Envoy** как reverse proxy наряду с Nginx
-   **Service Worker** с `postMessage`-событиями для состояния авторизации
-   **Core-js** для полифиллов и совместимости

---

## Где могла бы быть боль у фронта

-   **Интерактивные задания**: уникальные форматы задач, которые нужно поддерживать, валидировать, адаптировать под разные устройства.
-   **Много A/B-тестов**: пересекаются с фичами, усложняют тестирование. GTM и кастомные `tracker.js` показывают, что логика разделения может быть глубоко встроена.
-   **Скорость**: дети теряют фокус, если страница долго грузится. Критична быстрая подгрузка.
-   **Роли и доступы**: ученик ≠ родитель ≠ учитель. Нужно соблюдать чёткие границы.
-   **Нестабильный интернет**: fallback, кеширование, повторная отправка результатов. Используется `service worker` для обработки fetch-запросов на `/auth`, с возможностью восстановления токенов.
-   **Прогресс и синхронизация**: между сессиями, между устройствами, между ролями. Присутствует синхронизация состояния авторизации между вкладками через `clients.matchAll()` и передачу `state` по `postMessage`.

---

## Интересные детали, которые хочется пощупать

-   Как реализована синхронизация заданий между учениками и учителем?
-   Используются ли placeholder’ы при загрузке chunk’ов?
-   Как обрабатываются ошибки при нестабильном соединении?
-   Есть ли механизм ретраев при отправке решения?
-   Как устроено A/B-распределение между группами?
-   Насколько задания «жёстко» зашиты в код — или редактируются через CMS?
-   Какая система событий используется для аналитики и прогресса?
-   Как устроен `service worker` и какие данные он обрабатывает?
-   Проксируется ли вся аутентификация через него — и насколько это влияет на UX?

---

## Что стоит пощупать руками

### Курсы и задания

-   Валидация ответов
-   Переход между экранами
-   Визуальные анимации успеха/ошибки
-   Кеширование задач

### Кабинеты

-   Роли (ученик, учитель, родитель)
-   Отображение статистики
-   Встроенные уведомления
-   UX взаимодействий

### Олимпиады

-   Таймеры, блокировки, античит
-   Сохранение прогресса
-   Сброс / перезапуск

### Магазин

-   Оплата, подписки, ограничения
-   Paywall'ы и уровни доступа
-   Активация премиума

### Уведомления

-   Email, Push, внутренняя система
-   События-триггеры
-   Возможность настройки / отключения
